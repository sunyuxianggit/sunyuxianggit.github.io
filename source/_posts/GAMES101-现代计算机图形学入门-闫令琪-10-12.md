---
title: GAMES101-现代计算机图形学入门-闫令琪(10-12)
date: 2020-04-10 10:21:16
tags: computer graphics
---

## 第十节
##### 上节课复习
![](2020-04-10-10-41-40.png)
1. 花了两节课学了着色，学了特定的Blinn-Phong着色模型
2. 在什么地方做着色，计算机的硬件如何做着色
3. 关于纹理映射的问题，用纹理定义逐点的属性
4. 怎么样做插值，在三个顶点定义属性，然后在三角形内部任意点怎么做，用重心坐标。
5. 纹理贴在表面上，纹理过小怎么办，做插值，纹理过大怎么办，mipmap范围查询。
![](2020-04-10-10-52-00.png)
给一个mesh，可以做flat shading，也可以phong shading ，也可以贴图，然后叠加各种不同的图。
今天学习反射，反射的东西是什么？拿什么东西去表述它。

##### 纹理的应用（环境光照）
![](2020-04-10-11-01-40.png)
纹理：本质是一张图，纹理本身可以做各种操作，比如mipmap，因为应用广泛，所以现在硬件都是可以支持的。  
所以在现在的GPU里面，可以把纹理理解为一块内存，以及可以在块内存上可以实现点/范围查询和滤波。  
纹理理解为一块数据，可以做不同类型查询。
从这个角度上出发，纹理可以表述的东西太多了。

###### 环境贴图
纹理可以用来表诉环境光，又叫环境光照，环境光映射。
![](2020-04-10-11-08-30.png)
不区分直接光还是反射光，总之是四面八方有光进入。在这个空间内渲染茶壶，它会被四面八方的光所照亮，也就意味着它会反射任何方向来的光。
我们可以利用纹理去描述整个环境光长什么样，用这个环境光渲染其它物体，要比点光源要好很多，怎么算之后再说。
经典模型: 犹他茶壶，斯坦福的龙和斯坦福的兔子，connel box（康奈尔的盒子）。
用纹理去描述环境光的时候，有一个假设是环境光会来自无限远处，只记录一个不同方向即可（其实不能只记录方向，应该是方向和位置）
![](2020-04-10-12-08-50.png)

环境光是怎么来了，我们在屋子里面放一个金属球，这个金属球整个反射出来的就是环境光。
可以利用这个特性把环境光存储到一个球上，然后就像展开地球仪一样展开这个球。
* Sphere Map
![](2020-04-10-13-53-54.png)
![](2020-04-10-13-54-40.png)
这里地面和顶上会有扭曲问题。就像地图一样，描述地球纬度高的地方会变小，纬度低的地方会变大，描述整个球上的位置是做到了，但是不是一个均匀的描述。怎么解决这个问题呢？
* Cube Map
![](2020-04-10-14-13-18.png)
还是用一个球，但是认为这个球有一个包围盒BoundingBox，假设从球心经过球面连一条线，这条线打到立方体的表面。然后把条线经过球面的值赋予给包围盒，也就是从球心做球面投影到立方体面上，这样就得到了六张贴图。
![](2020-04-10-16-47-38.png)
这个做法的缺点是，原本你想看来自某方向光线的值，可以很容易查询，现在还需判断一下在哪个面上。

Sphere Map 和 CubeMap，方式不同但是本质是一样的，都是为了描述不同方向的光照信息
**强调：光照信息，不一定只是直接光照，比如太阳光，你看到的任何物体，你能看到它，一定是因为有光线从它到达了你的眼睛，它们反射过来的光同样也是光照信息。**
###### 凹凸贴图
![](2020-04-10-17-19-10.png)
利用纹理描述物体的表面任意一个点的高度是什么，基础的平面沿着法线方向前进后退各多少。
在不把几何形体变复杂的情况下，应用一个复杂的纹理从而定义任何一个点相对的高度。
相对的高度一变，法线就会发生变化，法线发生变换，着色的结果就会发生变化，就会认为这里有凹凸。凹凸贴图和法线贴图实际上就是为了法线，但是实际上并没有改变几何。
![](2020-04-10-19-01-04.png)
纹理是怎么扰动法线的呢？黑色线是本身模型，黄色线应用了凹凸贴图的模型，点P经过应用凹凸贴图移动了之后，它的法线就被改变了，如何计算改变过后的法线值呢？
![](2020-04-10-19-04-23.png)
先考虑二维情况下，假设任何一个点，点P，原本的法线是(0,1)，蓝色线表示应用了凹凸贴图。
首先求出这个点的梯度（倒数）：既这个点向右移动一个单位，它的切线会向上移动多少单位。
用这个高度差除以间隔（1），在引入某一个常数，定义凹凸贴图的影响强度
24



##### 几何